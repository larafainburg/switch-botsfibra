<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Switch Envíos Pro</title>
<style>
  :root{
    --fg:#e8eefc; --sub:#94a3b8;
    --ok:#22c55e; --err:#ef4444;
    --border:rgba(255,255,255,.14);
  }
  *{box-sizing:border-box;margin:0;padding:0}
  html,body{height:100%}
  body{
    font-family: system-ui, sans-serif;
    display:grid; place-items:center;
    color:var(--fg);
    background: linear-gradient(-45deg, #0f172a, #1e3a8a, #4c1d95, #0f766e);
    background-size: 400% 400%;
    animation: gradientBG 15s ease infinite;
  }
  @keyframes gradientBG {
    0%{background-position:0% 50%}
    50%{background-position:100% 50%}
    100%{background-position:0% 50%}
  }

  .card{
    width:min(520px, 92vw);
    padding:28px;
    border-radius:26px;
    border:1px solid var(--border);
    background:rgba(255,255,255,.08);
    backdrop-filter: blur(20px);
    box-shadow: 0 18px 60px rgba(0,0,0,.6);
    display:flex; flex-direction:column; gap:24px;
    animation: fadeIn 1s ease;
  }
  @keyframes fadeIn {
    from{opacity:0; transform:translateY(20px)}
    to{opacity:1; transform:translateY(0)}
  }
  .title{text-align:center; font-weight:800; font-size:24px}
  .sub{text-align:center; color:var(--sub); font-size:15px}
  .action{display:flex; align-items:center; gap:18px; cursor:pointer; justify-content:center}

  /* Switch Pro */
  .switch{
    --w: 120px; --h: 60px; --p: 8px;
    position:relative; width:var(--w); height:var(--h);
    border-radius:999px; border:2px solid rgba(255,255,255,0.35);
    background:linear-gradient(180deg, #d1d5db, #9ca3af);
    box-shadow: inset 0 6px 12px rgba(0,0,0,.3);
    transition: background .4s ease, box-shadow .4s ease, transform .08s ease;
    overflow:hidden;
  }
  .switch:active{transform: scale(.97)}
  .knob{
    position:absolute; top:var(--p); left:var(--p);
    width:calc(var(--h) - var(--p)*2); height:calc(var(--h) - var(--p)*2);
    border-radius:50%; background: radial-gradient(circle at 30% 30%, #fff, #f3f4f6 60%, #e5e7eb);
    box-shadow:0 6px 12px rgba(0,0,0,.35),0 0 0 2px rgba(255,255,255,0.8) inset;
    transition: transform .35s cubic-bezier(.2,.8,.25,1), box-shadow .35s ease;
    z-index:2;
  }
  .switch[data-on="true"]{
    background: linear-gradient(90deg, #2563eb, #7c3aed, #0ea5e9);
    background-size:200% 200%;
    animation: glowMove 3s ease infinite;
    border-color: rgba(79,140,255,0.9);
    box-shadow: inset 0 6px 12px rgba(0,0,0,.25),0 0 20px rgba(79,140,255,.7);
  }
  .switch[data-on="true"] .knob{
    transform: translateX(calc(var(--w) - var(--h)));
    box-shadow:0 6px 14px rgba(79,140,255,.7),0 0 0 2px rgba(255,255,255,.9) inset;
  }
  @keyframes glowMove {
    0%{background-position:0% 50%}
    50%{background-position:100% 50%}
    100%{background-position:0% 50%}
  }

  .chip{display:inline-flex; align-items:center; gap:8px; padding:6px 12px; border-radius:999px; border:1px solid var(--border); background:rgba(255,255,255,.08); font-weight:600}
  .dot{width:9px; height:9px; border-radius:50%}
  .on .dot{background:var(--ok)}
  .off .dot{background:#64748b}
  .err .dot{background:var(--err)}
  .toast{position:fixed; left:50%; bottom:24px; transform:translate(-50%,20px); opacity:0; padding:10px 14px; border-radius:12px; border:1px solid var(--border); background:#0b1326; color:var(--fg); box-shadow: 0 12px 30px rgba(0,0,0,.5); transition:opacity .25s ease, transform .25s ease}
  .toast.show{opacity:1; transform:translate(-50%,0)}
  .toast.ok{border-color:var(--ok)}
  .toast.err{border-color:var(--err)}
</style>
</head>
<body>
<article class="card">
  <header>
    <h1 class="title">Interruptores Envíos</h1>
    <p class="sub">Prendé o apagá los servicios.</p>
  </header>

  <!-- FITNESS -->
  <div class="action" id="rowFitness">
    <button id="switchFitness" class="switch" role="switch" aria-checked="false" data-on="false">
      <span class="knob"></span>
    </button>
    <span id="badgeFitness" class="chip off"><span class="dot"></span><span id="txtFitness">Fitness (Apagado)</span></span>
  </div>

  <!-- ROPA -->
  <div class="action" id="rowRopa">
    <button id="switchRopa" class="switch" role="switch" aria-checked="false" data-on="false">
      <span class="knob"></span>
    </button>
    <span id="badgeRopa" class="chip off"><span class="dot"></span><span id="txtRopa">Ropa (Apagado)</span></span>
  </div>
</article>

<div id="toast" class="toast"></div>

<script>
// URLs de Fitness
const URL_ON_FITNESS  = "https://n8n-n8n.uqdje4.easypanel.host/webhook/ddf84ac6-3dfb-428a-8cb7-9c0e58682b19";
const URL_OFF_FITNESS = "https://n8n-n8n.uqdje4.easypanel.host/webhook/2441f78c-07c6-4e7a-973b-eb35d04cd571";

// URLs de Ropa
const URL_ON_ROPA  = "https://n8n-n8n.uqdje4.easypanel.host/webhook/38d1fbc2-1318-4281-b9a5-fe8598531118";
const URL_OFF_ROPA = "https://n8n-n8n.uqdje4.easypanel.host/webhook/5833dd0e-fae1-4ad2-bfff-c582d91ff0ac";

function setupSwitch(prefix, urlOn, urlOff){
  const row = document.getElementById("row"+prefix);
  const sw = document.getElementById("switch"+prefix);
  const badge = document.getElementById("badge"+prefix);
  const txt = document.getElementById("txt"+prefix);
  let current = false;

  function setVisual(on){
    current = on;
    sw.dataset.on = on ? 'true':'false';
    sw.setAttribute('aria-checked', String(on));
    badge.className = `chip ${on ? 'on':'off'}`;
    txt.textContent = prefix+" ("+(on ? "Prendido" : "Apagado")+")";
  }

  async function toggle(){
    const next = !current;
    setVisual(next);
    const url = next ? urlOn : urlOff;
    const ok = await fire(url).catch(()=>false);
    if(ok){
      toast(prefix+" "+(next ? "Activado ✔":"Desactivado ✔"),'ok');
    }else{
      setVisual(!next);
      toast("Error ❌",'err');
    }
  }

  row.addEventListener("click", toggle);
  sw.addEventListener("keydown",e=>{ if(e.key===' '||e.key==='Enter'){ e.preventDefault(); toggle(); }});
  setVisual(false);
}

function toast(msg,type='ok'){
  const el = document.getElementById("toast");
  el.textContent = msg;
  el.className = `toast show ${type}`;
  setTimeout(()=> el.classList.remove('show'),1700);
}
function fire(url){
  return fetch(url,{method:'POST'}).then(()=>true);
}

// Inicializar switches
setupSwitch("Fitness", URL_ON_FITNESS, URL_OFF_FITNESS);
setupSwitch("Ropa", URL_ON_ROPA, URL_OFF_ROPA);
</script>
</body>
</html>

